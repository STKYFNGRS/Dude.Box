<section class="section">
  <div class="container">
    <div class="badge muted">Cart</div>
    <h1 class="section-title" style="font-size: 2.25rem; margin: 1rem 0;">Your Drop</h1>
    {% if cart.item_count == 0 %}
      <p class="muted">Your cart is empty.</p>
      <a href="/collections/all" class="solid-button" style="padding: 0.75rem 1.5rem; border-radius: 999px;">
        Shop All
      </a>
    {% else %}
      <form action="{{ routes.cart_url }}" method="post" novalidate>
        {% for item in cart.items %}
          <div class="cart-line">
            <div>
              {% if item.image %}
                <img
                  src="{{ item.image | image_url: width: 120 }}"
                  alt="{{ item.product.title }}"
                  style="width: 100px; height: 100px; object-fit: cover; border-radius: 0.75rem; border: 1px solid var(--color-border);"
                >
              {% endif %}
            </div>
            <div>
              <div class="section-title" style="font-size: 1.15rem;">{{ item.product.title }}</div>
              <div class="muted" style="font-size: 0.9rem;">{{ item.variant.title }}</div>
              <div style="margin-top: 0.5rem;">{{ item.price | money }}</div>
            </div>
            <div>
              <label class="muted" style="text-transform: uppercase; letter-spacing: 0.2em; font-size: 0.65rem;">
                Qty
                <input class="input" type="number" name="updates[]" value="{{ item.quantity }}" min="0" style="margin-top: 0.5rem; max-width: 80px;">
              </label>
            </div>
          </div>
        {% endfor %}

        <div class="card" style="border-radius: 1rem; padding: 1.5rem; margin-top: 2rem;">
          <label style="display: flex; align-items: center; gap: 0.75rem; font-size: 0.95rem;">
            <input
              type="checkbox"
              name="attributes[is_gift]"
              value="yes"
              {% if cart.attributes.is_gift == 'yes' %}checked{% endif %}
            >
            Is this a gift?
          </label>
          <div id="gift-note-field" style="margin-top: 1rem; {% if cart.attributes.is_gift != 'yes' %}display:none;{% endif %}">
            <label class="muted" style="text-transform: uppercase; letter-spacing: 0.2em; font-size: 0.7rem;">
              Gift Note
              <textarea
                class="textarea"
                name="attributes[gift_note]"
                rows="4"
                style="margin-top: 0.5rem;"
              >{{ cart.attributes.gift_note }}</textarea>
            </label>
          </div>
        </div>

        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 2rem;">
          <div class="section-title" style="font-size: 1.25rem;">Subtotal</div>
          <div style="font-size: 1.25rem;">{{ cart.total_price | money }}</div>
        </div>

        <div class="button-row" style="margin-top: 1.5rem;">
          <button type="submit" name="update" class="outline-button" style="padding: 0.75rem 1.5rem; border-radius: 999px;">
            Update Cart
          </button>
          <button type="submit" name="checkout" class="solid-button" style="padding: 0.75rem 1.5rem; border-radius: 999px;">
            Checkout
          </button>
        </div>
      </form>
      <script>
        const giftToggle = document.querySelector('input[name="attributes[is_gift]"]');
        const giftField = document.getElementById('gift-note-field');
        if (giftToggle && giftField) {
          giftToggle.addEventListener('change', () => {
            giftField.style.display = giftToggle.checked ? 'block' : 'none';
          });
        }
      </script>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Main cart items",
  "settings": []
}
{% endschema %}
